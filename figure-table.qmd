---
highlight-style: github # with `a11y` python imports disappear into background
echo: false
---

```{r}
#| include: false
{{< include _examples/figure-table/_code-snippets/setup.R >}}
```

# Figures and tables {#sec-figures-and-tables}

## Overview

Most common kinds of output from computational cells. 
Also the ones you get some of the biggest gains from literate programming.

Images and markdown tables discussed in ...

Components of a figure



comparison of syntax

Does engine matter? Does language matter?

Broadly speaking, do everything via chunk options, or just use code to create the image/table and do everything with divs.

I need to:

* Cross-reference my figure/table 

* Change the position of the figure/table

* Arrange multiple figures and/or tables in a single panel

* Change the format or location of the caption

* Control the size or aspect ratio of my figure

* Control the styling of my table 

* Troubleshoot the table or figure output from a particular package


### The examples in this chapter

We wanted authentic examples of figures and tables generated by code in this chapter.
However, the focus of this chapter isn't on the code, and we don't want it to distract you.
To balance those objectives we've selected a small number of examples that we'll repeat throughout the chapter.
These examples are designed to be almost identical between R and Python, 
but this means they are created with a very limited set of packages (ggplot2 and GT in R, and plotnine and great_tables in Python).

We've provided examples in both R and Python so you can reproduce them in your favorite language.
The concepts you are learning are language (and package) agnostic, 
so while the executable code is different,
the code cell options, and markdown syntax are identical.

The code to generate the example figures and tables is shown without any other context.
If you want to recreate them, you'll need the setup code as shown in @fig-setup.
We also show the rendered examples without a code echo, i.e. we set `echo: false` in our document header:

```{.yaml filename="document.qmd"}
---
echo: false
---
```

::: {#fig-setup}

:::{.panel-tabset}

## R

````{.r filename="setup.R"}
{{< include _examples/figure-table/_code-snippets/setup.R >}}
````

## Python

```{.python filename="setup.py"}
{{< include _examples/figure-table/_code-snippets/setup.py >}}
```

:::

Code required before executing the examples in this chapter

:::



| Option | Description | Reference |
|--------|-------------|-----------|
|`label` | ID for output, also used for cross-references. | @sec-figtab-basic, start with `tbl` or `fig` to number and cross-reference, see @sec-figtab-crossrefs. |
| `fig-cap` | Caption for figure                          | @sec-figtab-basic, can be an array if you produce multiple figures, see @sec-multiple-outputs. |
| `tbl-cap` | Caption for table                           | @sec-figtab-basic, can be an array if you produce multiple tables, see @sec-multiple-outputs. |
| `fig-alt` | Alternative text description of the figure  | @sec-figtab-basic, can be an array if you produce multiple figures, see @sec-multiple-outputs |

: Quick Reference for code cell options for figures and tables 

## Basic cell options {#sec-figtab-basic}

The chunk options you'll use most often are the analogs of those you would set with markdown when including a non-computational table or figure in a Quarto document.
These options are:

*  `label`: The ID for the resulting figure/table. You must omit the `#`. 
    If the label starts with `fig-` or `tbl-`, the figure or table will be numbered, and can be cross-referenced. 

*  `fig-cap`/`tbl-cap`: The caption for the resulting figure/table. 
    Use standard YAML syntax for long strings (@sec-yaml-long-strings) if you need to break across lines, but ensure each line starts with `#|`. (TODO: Currently not true for `jupyter` engine. Check on state of <https://github.com/quarto-dev/quarto-cli/issues/11290>)

*  `fig-alt`: Alternative text for the resulting figure. There is no `tbl` equivalent, because tables are text-based and generally accessible to screen readers.

@fig-tbl-compare and @fig-fig-compare compare the syntax for non-computational and computational tables and figures using placeholders (in uppercase) for the content.

::: {#fig-tbl-compare}

:::{}
```{.markdown}
MARKDOWN TABLE

: CAPTION {#LABEL}
```

Markdown table

:::

:::{}
````{.markdown}
```{{LANGUAGE}}
#| label: LABEL
#| tbl-cap: CAPTION

# CODE
```
````

Computational table
:::

A comparison of the syntax for a table created with markdown, and a table created in a code cell. TODO: turn this into a diagram so we can color code the same info

::: 

::: {#fig-fig-compare}

:::{}
```{.markdown}
![CAPTION](PATH){#LABEL fig-alt="ALT TEXT"}
```

Markdown figure
:::

:::{}
````{.markdown}
```{{LANGUAGE}}
#| label: LABEL
#| fig-cap: CAPTION
#| fig-alt: ALT TEXT

# CODE
```
````

Computational figure

:::

A comparison of the syntax for a figure created with markdown, and a figure created in a code cell.  TODO: turn this into a diagram so we can color code the same info

::: 

As a concrete example, consider the non-computational table in @lst-markdown-table.

:::{#lst-markdown-table}
```{.markdown .code-overflow-wrap}
| species    | n   |
|------------|-----|
| Adelie     | 152 |
| Chinstrap  | 68  |
| Gentoo     | 124 |

: Number of penguins sampled from each species in the Palmer Archipelago {#tbl-species-count}
```

Markdown to produce a captioned and numbered table
:::

This table could have instead been produced by an executable code cell, as shown in @fig-tables.

::: {#fig-tables}

::: {.panel-tabset group="language"}

## R

````{.markdown}
```{{r}}
#| label: tbl-species-count
#| tbl-cap: "Number of penguins sampled from each species in the Palmer Archipelago"

{{< include _examples/figure-table/_code-snippets/species-count.R >}}
```
````

## Python

````{.markdown}
```{{python}}
#| label: tbl-species-count
#| tbl-cap: "Number of penguins sampled from each species in the Palmer Archipelago"

{{< include _examples/figure-table/_code-snippets/species-count.py >}}
```
````

:::

Basic table chunk options used for a computational table. Compare to @lst-markdown-table

:::

When rendered the result is:

:::{.border .p-3}
```{r}
#| label: tbl-species-count
#| echo: false
#| tbl-cap: |
#|   Number of penguins sampled from each 
#|   species in the Palmer Archipelago

{{< include _examples/figure-table/_code-snippets/species-count.R >}}
```
:::

Similarly, @lst-markdown-figure shows a non-computational figure, that could instead be produced using the code cells shown in @fig-figures.

::: {#lst-markdown-figure}

```{.markdown .code-overflow-wrap}
![Penguin bill length versus depth by species](images/width-vs-depth.png){#fig-scatter fig-alt="Scatter plot of bill length vs. depth showing distinct species clustering."}
```

Markdown used to include a non-computational figure.
:::

::: {#fig-figures}

::: {.panel-tabset group="language"}

## R

````{.markdown}
```{{r}}
#| label: fig-scatter
#| fig-cap: "Penguin bill length versus depth by species"
#| fig-alt: "Scatter plot of bill length vs. depth showing distinct species clustering."

{{< include _examples/figure-table/_code-snippets/bill-scatter.R >}}
```
````

## Python

````{.markdown}
```{{python}}
#| label: fig-scatter
#| fig-cap: "Penguin bill length versus depth by species"
#| fig-alt: "Scatter plot of bill length vs. depth showing distinct species clustering."

{{< include _examples/figure-table/_code-snippets/bill-scatter.py >}}
```
````

:::

Basic figure chunk options used for a computational figure. Compare to @lst-markdown-figure.

:::

The result is:

::: {.border .p-3}

```{r}
#| label: fig-scatter
#| fig-cap: "Penguin bill length versus depth by species"
#| fig-alt: "Scatter plot of bill length vs. depth showing distinct species clustering."

{{< include _examples/figure-table/_code-snippets/bill-scatter.R >}}
```

:::





### Consistent across engines/languages

## Cross-References {#sec-figtab-crossrefs}

Start your label with `tbl-` or `fig-`. 
See other cross-reference types in @sec-crossreferences

### Fenced div syntax

Alternative to setting `label` and `fig-cap`/`tbl-cap` as code cell options
Set identifier as ID in fenced div
Use code cell to generate table or figure
Caption is last line in div

#### Dynamic captions

#### Long captions


### Multiple figures or tables

Use array for `fig-subcap` / `tbl-subcap`
Can reference with `@fig-label-1`.

Use `layout` to control arrangement.
Also see mixed examples in Layout section.






## Using fenced div syntax instead of code cell options

The above examples illustrate one approach to controlling computational figures and tables---setting code cell options.
An alternative approach is to use the code cell purely to produce the table or figure and use Quarto's fenced div syntax to control how the table or figure is included in the document.



::: {.panel-tabset group="language"}

## R

````{.markdown}
::: {#tbl-species-count}

```{{r}}
{{< include _examples/figure-table/_code-snippets/species-count.R >}}
```

Number of penguins sampled from each species in the Palmer Archipelago

:::
````

## Python

````{.markdown}
::: {#tbl-species-count}

```{{python}}
{{< include _examples/figure-table/_code-snippets/species-count.py >}}
```

Number of penguins sampled from each species in the Palmer Archipelago

:::
````

:::

## Captions

### Using fenced divs

### Dynamic captions

### LaTeX short captions

### Caption location

### Caption titles and numbering

```{.yaml}
---
title: "My Document"
crossref:
  fig-title: Fig     # (default is "Figure")
  tbl-title: Tbl     # (default is "Table")
  title-delim: "â€”"   # (default is ":")
---
```

```{.yaml}
---
title: "My Document"
crossref:
  labels: alpha a        # (default is arabic)
  subref-labels: roman i # (default is alpha a)
---
```

### Caption Text


`tbl-colwidths`

### Caption relative to figure or table

`cap-location`, `fig-cap-location`, `tbl-cap-location`



## Layout

### Alignment 

`fig-align`



### Multiple tables and/or figures {#sec-multiple-outputs}

Arrays for `fig-cap`, `fig-alt`, `label`?


`layout-nrow` `layout-ncol` `layout`
`layout-halign` `layout-valign`


`tbl-subcap`, `fig-subcap`, can `fig-alt` be an array?

Using fenced divs instead. E.g. figure next to image. Table next to figure.

Putting multiple figures/tables in a panel: Using chunk options: i.e. all plots, tables computed in single code chunk 

### Relative to page

Placing figures/tables on page: column classes `column`, `fig-column`, `tbl-column`, latex fig pos, `fig-pos`

`panel`


### Relative to slide

`output-location`

## Figure Sizing

crossrefs, chunk options that are consistent across engines/languages, mention embed from a notebook where you create the fig or tbl, reference that it's like include but on steroids, chunk options that turn into fenced div attributes like layout, figure sizing

### Lightbox


### Getting plots to show up in `jupyter` engine

### Choosing formats of plots

### How to get tables into Quarto? HTML vs. markdown

### Interactive Components


## Examples used in this chapter


