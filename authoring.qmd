# Authoring {#sec-authoring}

When we say "authoring" we mean the process of adding content to a Quarto document---literally, the things you write in a `.qmd` file.
You'll start by reviewing the three basic components of a Quarto document: the document header, code cells and markdown text.

The rest of the chapter then focuses on the specific markdown syntax that Quarto uses to create rich documents.
Our goal is to give you a good overview of breadth of Quarto's authoring features, while delaying many of the details to later chapters of the book.
We also focus on syntax that is broadly supported across multiple output formats and cover specific format features where relevant in @sec-output-formats.

We suggest reading through the chapter in its entirety on your first reading, and then referring back to specific sections as needed when authoring your own documents.


## Document header

Top of the document inside `---`. 
Basic: `title`, `author`, `format`.
Sets document metadata and options.
Refer to Projects chapter to reduce duplication, YAML chapter for more details on syntax.

## Code cells

Executable code cells are blocks of code that can be run to produce output that is included in your document.
Inside `` ```{LANGUAGE} `` and `` ``` ``.
Often have code cell options inside. @sec-execution-options
`echo`, `include`.

If you want to include code that is highlighted, and displayed, but not executable, use a code block @sec-code-blocks.

Remind of distinction between interactive execution and execution as part of rendering.

Only put code, or code comments inside.

Generally, only one language per document. (depending on engine, might be able to mix code cell languages, e.g. knitr, r and python vis reticulate).

::: panel-tabset
### R

{{< embed notebooks/authoring-r.qmd#add echo=true >}}

### Python

{{< embed notebooks/authoring-python.qmd#add echo=true >}}

:::

::: panel-tabset

### R

{{< embed notebooks/authoring-r.qmd#plot echo=true >}}

### Python

{{< embed notebooks/authoring-python.qmd#plot echo=true >}}

:::

Can be used to generate images/figures, tables, raw markdown content.
Can be nested inside lists, callouts, fenced divs, ...

## Markdown text

Everything that isn't the document header, or an executable code cell, is interpreted as Quarto markdown.
Quarto markdown originally built on top of Pandoc markdown with extensions, so many Pandoc markdown work.
Now, Quarto has its own markdown parser, so some differences.
The rest of this chapter outlines the most important pieces of Quarto markdown syntax.

## Sections

Markdown syntax for headings. 
Usually `title` takes role of level-1 heading, so sections use `##`.
Can add attributes after in curly braces e.g. an ID, preface with `sec` to allow cross-references, or a class, like `.unlisted`. 

## Paragraphs

text followed by blank lines
Line breaks generally ignored. 

## Inline text elements

Things that can be part of a paragraph, heading, etc. 
Put the following sections in one big table, and add cross-references, footnotes, citations, and inline equations.
Explain most either "things" are block level, get there own section below.

### Text formatting

::: {.list-table header-cols=1} 

* - Markdown Syntax
  - Output

* - 

    ``` markdown
    *italics*, **bold**, ***bold italics***
    ```
  - *italics*, **bold**, ***bold italics***

* - 

    ``` markdown
    superscript^2^ / subscript~2~
    ```
  - superscript^2^ / subscript~2~
* - 

    ``` markdown
    ~~strikethrough~~
    ```
  - ~~strikethrough~~
* - 

    ``` markdown
    `verbatim code`
    ```
  - `verbatim code`
:::


### Other Spans {#other-spans}

To create text in small caps, that is underlined, or that is highlighted, use a span with one of the 
classes `.smallcaps`, `.underline` or `.mark` respectively.

::: {.list-table header-cols=1}

- - Markdown Syntax
  - Output

- - 

    ``` markdown
    [This text is smallcaps]{.smallcaps}
    ```
  - [This text is smallcaps]{.smallcaps}

- - 

    ``` markdown
    [This text is underlined]{.underline}
    ```
  - [This text is underlined]{.underline}

- - 
    
    ``` markdown
    [This text is highlighted]{.mark}
    ```
  - [This text is highlighted]{.mark}

:::

### Links {#links}

Automatic, inline, internal

::: {.list-table header-cols=1}
- - Markdown Syntax
  - Output
- -

    ``` markdown
    <https://quarto.org>
    ```
  - <https://quarto.org>

- -

    ``` markdown
    [Quarto website](https://quarto.org)
    ```  
  - [Quarto website](https://quarto.org)

- - 

    ``` markdown
    [Links section on this page](#links)
    ```
  - [Links section on this page](#links)
:::

See also @sec-crossreferences 

## Lists

an entire blank line above the list

(`*`, `+`, or  `-`) 
compact vs loose

`1.` actual numbers not important, will be renumbered

Nested, careful with indentation

Block content:

> However, subsequent paragraphs must be preceded by a blank line and indented to line up with the first non-space content after the list marker.

Task lists, definition lists.

## Code blocks {#sec-code-blocks}

`` ```LAUGUAGE ``, or `` ```{.LANGUAGE} `` for syntax highlighting without execution.
In this book, we use the later, allows easy addition of attributes.

## Tables {#sec-markdown-tables}

The simplest way to add a table to a Quarto document is to create a **markdown pipe table**, however cells in a markdown pipe table cannot contain block content like multiple paragraphs, code cells, or lists.
To have cells with complicated cell contents, you can use an alternative syntax called **list tables**.
You can also use **HTML table syntax**, regardless of your target format, to create tables in Quarto documents.
You won't usually write HTML syntax by hand, but it is a common output from computational packages that create tables.

### Markdown pipe tables

The simplest syntax for a table in Quarto markdown is known as the **pipe table**, named because columns are separated by the pipe (`|`) character. 
A pipe table consists of column headers, a separator row of dashes (`-`) and pipes (`|`), and data rows with pipe-separated cells.

@fig-markdown-table gives an example of a pipe table, along with its rendered output.
The line after the table, starting with `:`, is optional, and specifies the caption and any attributes for the table (inside curly braces `{}`).
For example, the table is given the ID `#tbl-perf` so it is numbered and can be cross-referenced.

::: {#fig-markdown-table}
::: {}
````markdown
{{< include _examples/authoring/tables/markdown-table.qmd >}}
````
::: 

::: {}
![](images/authoring-tbl-perf.png){fig-alt="Rendered markdown output shows a table titled 'Table 1: Training Performance', with three columns: 'Model', 'Accuracy', and 'Time'. The table has four rows."}
:::

Markdown syntax and rendered output for a markdown pipe table

:::


### List tables

TODO: Revisit this once the `list-tables` extension is bundled with Quarto. 

List tables use markdown list syntax to create tables where cells can contain multiple paragraphs, code cells, or lists.
List tables need to be wrapped in a fenced div with the class `list-table`.
Inside the div, each row is represented as list item, with each cell as an subitem.

For example, to create the same table content as @fig-markdown-table using a list table, you would include the following in your document:

````markdown
{{< include _examples/authoring/tables/list-table.qmd >}}
````

To add a caption and attributes nest it inside another fenced div with a label that starts with `tbl-` and whose final line is the caption:

````markdown
{{< include _examples/authoring/tables/list-table-caption.qmd >}}
````

To include more complicated content in cells, like code blocks or formulas, include them as you would in normal markdown, but maintain indentation for the list structure, and the required white space for the content type:

````markdown
{{< include _examples/authoring/tables/list-table-complicated.qmd >}}
````

### HTML tables

You can also use HTML to create tables in Quarto documents, regardless of your target format.
HTML tables aren't usually constructed by hand, but are often generated by code cells or copied from other tools.

As an example, to generate the same table as @fig-markdown-table with HTML, you could include the following in your document:

````markdown
{{< include _examples/authoring/tables/html-table.qmd >}}
````

### From a code cell

When the output from an executable code cell is a markdown or HTML table, 
it will be included in your Quarto document.

To add an identifier and caption to the table use the code cell options `label` and `tbl-cap` respectively:

````markdown
```{{LANGUAGE}}
#| label: tbl-example
#| tbl-cap: "Caption"

# Code that generates a markdown or HTML table
```
````

## Images and figures {#sec-markdown-figures}

Refer to @sec-figures for more details on positioning, layout, cross-references, and other advanced figure features.
Quarto uses the term figure to refer to any image, numbered or not, included in a document.
You may be more used to using the term figure to refer to an image with a numbered caption---Quarto calls this a cross-referenceable figure. 

### From a file

To include an image file in markdown you use the following syntax:

```markdown
![](path/to/image.png)
```

Where the path to the image is a path relative to the current document.

::: {.callout-tip}

## Project relative paths 

If you preface the path with `/`, it is interpreted as a path relative to the project root. 
You'll learn more about project structure in [Projects](#sec-projects).

:::

You can add a caption inside the square brackets, an identifier inside curly braces after the image path, and alternative text for accessibility in a `fig-alt` attribute:

```markdown
![Caption](path/to/image.png){#fig-quarto fig-alt="Alternative text"}
```

If your identifier starts with `fig-`, the image will be a cross-referenceable figure, numbered, and can be referenced using the `@` syntax.

### From a code cell

If the output from an executable code cell is an image, it will be automatically included in your document.
To add an identifier, caption, or alternative text use the code cell options `label`, `fig-cap`, and `fig-alt` respectively:

````markdown
```{{LANGUAGE}}
#| label: fig-quarto
#| fig-cap: "Caption"
#| fig-alt: "Alternative text"

# Code that generates a plot
```
````

## Equations

Use TeX math. Describe what inline and display mean. 
Adding numbering and cross-reference.
Inline: `$ ... $`
Display: `$$ ... $$` or `\[ ... \]`

Use `$` delimiters for inline math and `$$` delimiters for display math. For example:

+---------------------------+-------------------------+
| Markdown Syntax           | Output                  |
+===========================+=========================+
| ``` markdown              |                         |
| inline math: $E = mc^{2}$ | inline math: $E=mc^{2}$ |
| ```                       |                         |
+---------------------------+-------------------------+
| ``` markdown              |                         |
| display math:             | display math:           |
|                           |                         |
| $$E = mc^{2}$$            | $$E = mc^{2}$$          |
| ```                       |                         |
+---------------------------+-------------------------+

How are they processed. 
LaTeX, HTML, Word

## Cross-references {#sec-crossreferences}

General process:

1. Add label
2. Refer using `@label`

Give table of common examples: `fig`, `tbl`,  `lst`, `sec`, `eq`,, `callout`, `thm`, 

Refer to Quarto docs for more details.

### Reserved Prefixes 

Unless you are creating a cross-reference, avoid using the reserved cross-reference prefixes for code cell labels (e.g. set using the `label` code cell option) and element IDs (set using a `#` in an attribute). 
 
The reserved prefixes are: `fig`, `tbl`, `lst`, `tip`, `nte`, `wrn`, `imp`, `cau`, `thm`, `lem`, `cor`, `prp`, `cnj`, `def`, `exm`, `exr`, `sol`, `rem`, `alg`, `eq`, `sec`.

Also avoid using underscores (`_`) in labels and IDs as this can cause problems when rendering to PDF with LaTeX.

Include syntax variations like `[Fig @fig-elephant]`, `[-@fig-elephant]`, `[@fig-elephant; @fig-panther]`.

## Citations {#sec-citations}

Quarto will use Pandoc to automatically generate citations and a bibliography in a number of styles. To use this capability, you will need:

-   A quarto document formatted with citations (see [Citation Markdown](#sec-citations)).

-   A bibliographic data source, for example a BibLaTeX (`.bib`) or BibTeX (`.bibtex`) file.

-   Optionally, a `CSL` file which specifies the formatting to use when generating the citations and bibliography (when not using `natbib` or `biblatex` to generate the bibliography).

::: {.callout-note}

When using `format: typst`, by default citation processing is handled by Typst, not Pandoc. See the [Typst](#typst) section below for more details.

::: 

Quarto supports bibliography files in a wide variety of formats including BibLaTeX and CSL. Add a bibliography to your document using the `bibliography` YAML metadata field. For example:

``` yaml
---
title: "My Document"
bibliography: references.bib
---
```

:::{.list-table header-cols=1}

- - Markdown Syntax
  - Output

- -

    ``` markdown
    @knuth1984 shows ...
    ```
  - @knuth1984 shows ...

- -

    ``` markdown
    ... [@knuth1984]
    ```
  - ... [@knuth1984]

- - 

    ``` markdown
    As Knuth [-@knuth1984] shows ...
    ```
  - As Knuth [-@knuth1984] shows ...

- - 

    ``` markdown
    [@knuth1984; @wickham2015]
    ```
  - [@knuth1984; @wickham2015]

:::


The appearance of the citations both inline and in the bibliography depends on the citation style as defined in a CSL file.
By default, Quarto use the [Chicago Manual of Style](https://chicagomanualofstyle.org/) author-date format, but you can provide a custom CSL file using the `csl` option field in your document header, for example:

``` yaml
---
title: "My Document"
bibliography: references.bib
csl: nature.csl
---
```

REad more in Quarto docs.

## Footnotes {#sec-footnotes}

Pandoc supports numbering and formatting footnotes using the following syntax:

``` markdown
Here is a footnote reference,[^1] and another.[^longnote]

[^1]: Here is the footnote.

[^longnote]: Here's one with multiple blocks.

    Subsequent paragraphs are indented to show that they
belong to the previous footnote.

        { some.code }

    The whole paragraph can be indented, or just the first
    line.  In this way, multi-paragraph footnotes work like
    multi-paragraph list items.

This paragraph won't be part of the note, because it
isn't indented.
```

The above syntax generates the following output:

:::{.border .p-3}
Here is a footnote reference,[^1] and another.[^2]

This paragraph won't be part of the note, because it isn't indented.
:::

In addition, you can also write single paragraph footnotes inline using the following syntax:

``` markdown
Here is an inline note.^[Inlines notes are easier to write,
since you don't have to pick an identifier and move down to
type the note.]
```

This syntax generates the following output:

::: {.border .p-3}
Here is an inline note.[^3]
:::

## Fenced divs {#sec-fenced-divs}

Although the term *Div* originates from the `<div>` tag in HTML, Quarto uses this term to refer to a markdown syntax for creating block-level regions of content that can have attributes like classes and identifiers.

For example, callout blocks (@sec-callouts) are specified using the div syntax, as are panel layouts, and positioning (@sec-layout).

A fenced div starts with at least three consecutive colons and optionally some attributes inside curly braces. 
The div ends with another line containing a string of at least three consecutive colons. 
The div should be separated by blank lines from preceding and following blocks. 

For example, here we add the "border" class to a region of content using a div (`:::`):

``` markdown
::: {.border}
This content can be styled with a border
:::
```

Divs may also be nested. For example

``` markdown
::::: {#special .sidebar}

::: {.warning}
Here is a warning.
:::

More content.
:::::
```

Fences without attributes are always closing fences.
In practice, this means you sometimes add empty attributes.


## Callouts

``` markdown
:::{.callout-note}
Note that there are five types of callouts, including: 
`note`, `tip`, `warning`, `caution`, and `important`.
:::
```

## Layout {#sec-layout}

Using divs with classes and/or attributes to create layouts.

`layout-*` attributes to arrange items 

`.column` classes to use parts of the page https://quarto.org/docs/authoring/article-layout.html#available-columns

## Raw blocks 

A way to include raw syntax for specific output formats.

````markdown
```{=html}

```
````

See examples in documents chapter.

## Includes {#sec-includes}

A way to split your document into multiple files, and include them.
Reduce duplication.

`{{< include path/to/file >}}`

Can use inside code cells

Name starting with `_` (more important in projects)

Don't usually include document headers.



## Other features

* Diagrams
* Other shortcodes: videos, placeholder text, `meta`, `var`
* Keyboard shortcuts